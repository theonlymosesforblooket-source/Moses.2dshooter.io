<!DOCTYPE html>
<html>
<head>
    <title>Zombie Arena 3D - Chromebook</title>
    <style>
        * { margin:0; padding:0; }
        body { background:#000; overflow:hidden; font:14px monospace; }
        canvas { display:block; width:100vw; height:100vh; }
        #ui {
            position:fixed; top:10px; left:10px; color:#0ff; 
            background:rgba(0,0,0,0.7); padding:10px; border-radius:5px;
        }
    </style>
    <!-- Chromebook-safe CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <div id="ui">
        Round: <span id="round">1</span> | Kills: <span id="kills">0</span> | 
        Bullets: <span id="bullets">1</span> | Use WASD + Mouse
    </div>

    <script>
        // Chromebook-safe setup
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x000011);
        const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias:false });
        renderer.setSize(innerWidth, innerHeight);
        document.body.appendChild(renderer.domElement);

        // Bright lights for Chromebook
        scene.add(new THREE.AmbientLight(0x444444, 1));
        const sun = new THREE.DirectionalLight(0xffffff, 1);
        sun.position.set(0, 50, 20);
        scene.add(sun);

        // Glowing floor
        const floor = new THREE.Mesh(
            new THREE.PlaneGeometry(200, 200),
            new THREE.MeshBasicMaterial({color: 0x112244})
        );
        floor.rotation.x = -Math.PI/2;
        scene.add(floor);

        // Player (cyan cube)
        const player = new THREE.Mesh(
            new THREE.BoxGeometry(2,2,2),
            new THREE.MeshBasicMaterial({color: 0x00ffff})
        );
        player.position.y = 1;
        scene.add(player);

        // Game vars
        let round = 1, kills = 0, bulletCount = 1;
        let bullets = [], zombies = [], gameRunning = true;
        let keys = {}, mouseX = 0, mouseY = 0;
        let cooldown = 0;

        // Input
        onkeydown = e => keys[e.code] = 1;
        onkeyup = e => keys[e.code] = 0;
        onmousemove = e => {
            mouseX = (e.clientX/innerWidth)*2-1;
            mouseY = -(e.clientY/innerHeight)*2+1;
        };

        // Shoot
        function shoot() {
            if(cooldown > 0 || !gameRunning) return;
            cooldown = 20;
            
            for(let i = 0; i < bulletCount; i++) {
                const bullet = new THREE.Mesh(
                    new THREE.SphereGeometry(0.2),
                    new THREE.MeshBasicMaterial({color: 0xffff00})
                );
                bullet.position.copy(player.position);
                
                const aim = new THREE.Vector3(mouseX*20, 0, mouseY*20).normalize();
                bullet.userData.vx = aim.x * 0.8;
                bullet.userData.vz = aim.z * 0.8;
                
                scene.add(bullet);
                bullets.push(bullet);
            }
        }

        // Spawn zombies
        function spawnZombies() {
            zombies.forEach(z => scene.remove(z));
            zombies = [];
            for(let i = 0; i < round+2; i++) {
                const zombie = new THREE.Mesh(
                    new THREE.BoxGeometry(1.5,3,1.5),
                    new THREE.MeshBasicMaterial({color: 0x00ff00})
                );
                zombie.position.set(
                    (Math.random()-0.5)*80,
                    1.5,
                    (Math.random()-0.5)*80
                );
                scene.add(zombie);
                zombies.push(zombie);
            }
        }

        // Game loop
        function loop() {
            requestAnimationFrame(loop);

            // Player move
            const speed = 0.5;
            if(keys.KeyW) player.position.z -= speed;
            if(keys.KeyS) player.position.z += speed;
            if(keys.KeyA) player.position.x -= speed;
            if(keys.KeyD) player.position.x += speed;

            if(keys.Space) shoot();
            if(cooldown > 0) cooldown--;

            // Camera follow
            camera.position.set(player.position.x, 30, player.position.z-20);
            camera.lookAt(player.position);

            // Bullets
            for(let i = bullets.length-1; i>=0; i--) {
                const b = bullets[i];
                b.position.x += b.userData.vx;
                b.position.z += b.userData.vz;
                
                if(b.position.length() > 60) {
                    scene.remove(b); bullets.splice(i,1); continue;
                }

                // Hit zombies
                for(let j = zombies.length-1; j>=0; j--) {
                    const z = zombies[j];
                    if(b.position.distanceTo(z.position) < 1.5) {
                        scene.remove(b); scene.remove(z);
                        bullets.splice(i,1);
                        zombies.splice(j,1);
                        kills++;
                        break;
                    }
                }
            }

            // Zombies chase
            zombies.forEach(z => {
                const dx = player.position.x - z.position.x;
                const dz = player.position.z - z.position.z;
                const dist = Math.sqrt(dx*dx + dz*dz) || 1;
                z.position.x += (dx/dist)*0.08;
                z.position.z += (dz/dist)*0.08;
                z.rotation.y = Math.atan2(dx, dz);

                if(z.position.distanceTo(player.position) < 2) {
                    alert(`GAME OVER\nRound: ${round}\nKills: ${kills}`);
                    round = 1; kills = 0; bulletCount = 1;
                    spawnZombies();
                }
            });

            // Next round
            if(zombies.length === 0 && gameRunning) {
                round++;
                spawnZombies();
            }

            // Update UI
            document.getElementById('round').textContent = round;
            document.getElementById('kills').textContent = kills;
            document.getElementById('bullets').textContent = bulletCount;

            renderer.render(scene, camera);
        }

        // Start
        spawnZombies();
        loop();

        onresize = () => {
            camera.aspect = innerWidth/innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(innerWidth, innerHeight);
        };
    </script>
</body>
</html>
